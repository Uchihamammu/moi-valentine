<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Moi ‚ù§Ô∏è</title>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* RESET & BODY */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            font-family: 'Courier New', Courier, monospace; 
            overflow: hidden;
            color: #333;
        }

        /* BACKGROUND HEARTS */
        .bg-heart {
            position: absolute;
            top: -10vh;
            font-size: 1.5rem;
            color: #ff4d6d;
            opacity: 0.6;
            animation: fall linear forwards;
            z-index: 0;
        }

        @keyframes fall {
            to { transform: translateY(110vh) rotate(360deg); }
        }

        /* MAIN CARD */
        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(255, 77, 109, 0.2);
            text-align: center;
            z-index: 10;
            max-width: 90%;
            width: 420px;
            border: 2px solid #ffccd5;
            transition: transform 0.3s ease;
            position: relative;
        }

        .card:hover { transform: translateY(-5px); }

        h1 {
            color: #ff4d6d;
            font-size: 2.2rem;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* TYPING EFFECT */
        .joke-container {
            min-height: 60px; 
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
        }

        .typewriter {
            font-size: 1.1rem;
            color: #590d22;
            font-weight: bold;
            border-right: 3px solid #ff4d6d;
            white-space: pre-wrap;
            animation: blink 0.75s step-end infinite;
        }

        .highlight {
            color: #d90429;
            font-size: 1.3rem;
            background: #ffe3e9;
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
            transform: rotate(-2deg);
        }

        @keyframes blink { 50% { border-color: transparent; } }

        /* BUTTONS */
        .button-box {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            min-height: 50px; 
        }

        .btn {
            background: #ff4d6d;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            box-shadow: 0 4px 15px rgba(255, 77, 109, 0.4);
            transition: all 0.2s;
            font-weight: bold;
            white-space: nowrap;
        }

        .btn:hover { background: #d90429; transform: scale(1.05); }
        
        /* The Runaway Button */
        #noBtn {
            background: #590d22;
            position: relative; 
            transition: 0.1s; 
        }

        /* PHOTO & HIDDEN MESSAGE */
        .hidden-content {
            display: none;
            margin-top: 20px;
            animation: fadeIn 2s ease-in-out;
        }

        .moi-photo {
            width: 150px;
            height: 150px;
            object-fit: cover;
            margin: 0 auto 15px auto;
            display: block;
            background-color: transparent;
            
            /* HEART SHAPE CUTTER */
            clip-path: path("M75,135 C15,90 0,45 37.5,22.5 C56,11 75,45 75,45 C75,45 94,11 112.5,22.5 C150,45 135,90 75,135 Z");
            
            /* DREAMY GLOW + FILTER */
            filter: contrast(1.1) brightness(1.1) blur(0.5px) drop-shadow(0 0 10px rgba(255, 77, 109, 0.6));
        }

        .msg-text {
            color: #800f2f;
            font-size: 1rem;
            line-height: 1.6;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <audio id="bg-music" loop>
        <source src="song.mp3" type="audio/mpeg">
    </audio>

    <div class="card">
        <div style="font-size: 3rem; margin-bottom: 10px;">üíå</div>
        
        <h1>Hey, MOI ‚ù§Ô∏è</h1>
        
        <div class="joke-container">
            <span id="joke-text" class="typewriter"></span>
        </div>

        <div class="button-box" id="btn-container">
            <button class="btn" id="yesBtn" onclick="startSurprise()">YES, OF COURSE</button>
            
            <button class="btn" id="noBtn" onmouseover="dodge()" ontouchstart="dodge()" onclick="dodge()">NO</button>
        </div>
        
        <div id="final-content" class="hidden-content">
            <img src="moi.jpg.JPG" alt="Moi" class="moi-photo">
            
            <div class="msg-text">
                (And I promise to always be your favorite person to talk nonsense with.) <br><br>
                <b style="font-size: 1.2rem; color: #d90429;">Happy Valentine's Day! ‚ù§Ô∏è</b>
            </div>
        </div>
    </div>

    <script>
        // CONFIG
        const textToType = "I LIKE IT WHEN YOU CALL ME NONSENSE";
        const typeSpeed = 80; 
        let i = 0;
        const jokeElement = document.getElementById("joke-text");

        // HEART RAIN
        function createHeart() {
            const heart = document.createElement("div");
            heart.classList.add("bg-heart");
            heart.innerText = Math.random() > 0.5 ? "‚ù§Ô∏è" : "üå∏";
            heart.style.left = Math.random() * 100 + "vw";
            heart.style.animationDuration = Math.random() * 3 + 3 + "s";
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 6000);
        }
        setInterval(createHeart, 400);

        // TYPING LOGIC
        function typeWriter() {
            if (i < textToType.length) {
                if (textToType.substring(i, i + 8) === "NONSENSE") {
                    const span = document.createElement("span");
                    span.classList.add("highlight");
                    span.innerText = "NONSENSE";
                    jokeElement.appendChild(span);
                    i += 8;
                } else {
                    jokeElement.innerHTML += textToType.charAt(i);
                    i++;
                }
                setTimeout(typeWriter, typeSpeed);
            } else {
                jokeElement.style.borderRight = "none";
            }
        }

        // RUNAWAY BUTTON LOGIC WITH COLLISION DETECTION
        function dodge() {
            const noBtn = document.getElementById('noBtn');
            const yesBtn = document.getElementById('yesBtn');
            const card = document.querySelector('.card'); 
            
            // Move within card bounds
            const maxX = card.offsetWidth - noBtn.offsetWidth - 20;
            const maxY = card.offsetHeight - noBtn.offsetHeight - 20;

            let x, y;
            let overlapping = true;
            let attempts = 0;

            // Keep generating random spots until it finds one that DOESN'T overlap with the YES button
            while (overlapping && attempts < 50) {
                x = Math.random() * maxX;
                y = Math.random() * maxY;

                // Get absolute positions to check for collision
                const yesRect = yesBtn.getBoundingClientRect();
                const cardRect = card.getBoundingClientRect();
                
                // Yes button coordinates relative to the card
                const yesLeft = yesRect.left - cardRect.left;
                const yesTop = yesRect.top - cardRect.top;
                const yesRight = yesLeft + yesRect.width;
                const yesBottom = yesTop + yesRect.height;

                // Proposed No button coordinates
                const noRight = x + noBtn.offsetWidth;
                const noBottom = y + noBtn.offsetHeight;

                // Add a 10px "safe zone" buffer around the Yes button
                const buffer = 10;

                // Collision Logic
                if (x < yesRight + buffer &&
                    noRight > yesLeft - buffer &&
                    y < yesBottom + buffer &&
                    noBottom > yesTop - buffer) {
                    overlapping = true; // Still overlapping, loop will run again
                } else {
                    overlapping = false; // Safe spot found!
                }
                attempts++;
            }

            noBtn.style.position = 'absolute'; 
            noBtn.style.left = x + 'px';
            noBtn.style.top = y + 'px';
        }

        // START SURPRISE
        function startSurprise() {
            // 1. Play Music 
            const audio = document.getElementById("bg-music");
            audio.volume = 0.6;
            audio.play().catch(e => console.log("Audio error:", e));

            // 2. Hide Buttons
            document.getElementById('btn-container').style.display = "none";

            // 3. CONFETTI EXPLOSION
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 }
            });

            // 4. Start Typing
            typeWriter();

            // 5. Reveal Photo & Message
            setTimeout(() => {
                document.getElementById("final-content").style.display = "block";
            }, textToType.length * typeSpeed + 500);
        }
    </script>
</body>
</html>
